<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TuneTrace ‚Äî POC (Vue)</title>
    <link rel="stylesheet" href="./styles.css" />
</head>

<body>
    <div id="app" class="wrap">
        <div class="card">
            <h1>üéß TuneTrace ‚Äî POC</h1>
            <p>Single screen demo: press the button to capture mic, send <span class="pill">WAV chunks</span> over
                WebSocket, and display the first match.</p>


            <div class="row">
                <span class="pill">WS: <span class="mono">{{ WS_URL }}</span></span>
                <span class="pill">API: <span class="mono">{{ API_BASE }}</span></span>
            </div>


            <button class="btn" :class="{recording: state.recording}" @click="toggle()">
                <span v-if="!state.recording">‚ñ∂ Start listening</span>
                <span v-else>‚èπ Stop listening</span>
            </button>


            <div class="grid">
                <div class="row"><span>Status</span><span class="pill">{{ state.status }}</span></div>
                <div class="row"><span>Chunks sent</span><span class="pill">{{ state.chunks }}</span></div>
                <div class="row"><span>Mic sample rate</span><span class="pill">{{ state.sampleRate || '‚Äî' }} Hz</span>
                </div>
            </div>


            <div class="divider"></div>


            <div v-if="state.match" class="grid">
                <div class="row"><strong>Match</strong><span class="pill">confidence: {{ state.match.confidence
                        }}</span></div>
                <div>
                    <div class="row"><span>Title</span><span class="mono">{{ state.match.title }}</span></div>
                </div>
                <div>
                    <div class="row"><span>Artist</span><span class="mono">{{ state.match.artist }}</span></div>
                </div>
                <div class="row"><span>Œît</span><span class="mono">{{ state.match.delta_ms }} ms</span></div>
                <div class="row"><span>Track ID</span><span class="mono">{{ state.match.song_id }}</span></div>
                <div class="divider"></div>
                <div class="row">
                    <button class="btn" @click="loadMedia()">Load media</button>
                </div>
                <div v-if="state.mediaUrl" class="small">Media URL: <span class="mono">{{ state.mediaUrl }}</span></div>
                <audio v-if="state.mediaUrl" :src="state.mediaUrl" controls preload="metadata"></audio>
            </div>


            <p class="small muted" style="margin-top:12px">
                Note: To play the full track directly from MinIO/S3, your bucket must be public or proxied and
                CORS‚Äëenabled. Set <span class="mono">MEDIA_BASE_URL</span> to something like <span
                    class="mono">http://localhost:9000/tunetrace-tracks/</span>.
            </p>
        </div>
    </div>


    <!-- Vue 3 ESM from CDN -->
    <script type="module" src="./app.js"></script>
</body>

</html>